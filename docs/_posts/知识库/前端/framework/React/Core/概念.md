---
title: React 概念
date: '2020-10-26'
draft: true
---

### JSX 如何防止注入攻击?

<!-- TODO: -->

React DOM 会在渲染 JSX 中嵌入的任何值之前对其进行转义。因此，它确保你永远不能注入任何未在应用程序中显式写入的内容。

```js
const name = response.potentiallyMaliciousInput;
const element = <h1>{name}</h1>;
```

这样可以防止应用程序中的 XSS（跨站点脚本）攻击。

### 除了在构造函数中绑定 `this`，还有其它方式吗

你可以使用属性初始值设定项(property initializers)来正确绑定回调，create-react-app 也是默认支持的。在回调中你可以使用箭头函数，但问题是每次组件渲染时都会创建一个新的回调。

### 在渲染方法中使用箭头函数好么?

在使用时需要优化性能。

```js
class Foo extends Component {
  handleClick() {
    console.log('Click happened');
  }
  render() {
    return <button onClick={() => this.handleClick()}>Click Me</button>;
  }
}
```

**注意：** 组件每次渲染时，在 render 方法中的箭头函数都会创建一个新的函数，这可能会影响性能。

### React 绑定 this

为什么要主动绑定 this ？

### 什么是 "key" 属性，在元素数组中使用它们有什么好处?

`key` 是一个特殊的字符串属性，你在创建元素数组时需要包含它。_Keys_ 帮助 React 识别哪些项已更改、添加或删除。

我们通常使用数据中的 IDs 作为 _keys_:

```jsx
const todoItems = todos.map(todo => <li key={todo.id}>{todo.text}</li>);
```

在渲染列表项时，如果你没有稳定的 IDs，你可能会使用 _index_ 作为 _key_：

```jsx
const todoItems = todos.map((todo, index) => <li key={index}>{todo.text}</li>);
```

**注意：**

由于列表项的顺序可能发生改变，因此并不推荐使用 _indexes_ 作为 _keys_。这可能会对性能产生负面影响，并可能导致组件状态出现问题。
如果将列表项提取为单独的组件，则在列表组件上应用 _keys_ 而不是 `li` 标签。
如果在列表项中没有设置 `key` 属性，在控制台会显示警告消息。

### 在 React 中的提升状态是什么?

当多个组件需要共享相同的更改数据时，建议将共享状态提升到最接近的共同祖先。这意味着，如果两个子组件共享来自其父组件的相同数据，则将状态移动到父组件，而不是在两个子组件中维护局部状态。

### 为什么有组件名称要首字母大写?

这是必要的，因为组件不是 DOM 元素，它们是构造函数。 此外，在 JSX 中，小写标记名称是指 HTML 元素，而不是组件。

### react 的 class 组件为什么需要在开头 import react？ 去掉能不能跑？

### React memo 函数是什么?

当类组件的输入属性相同时，可以使用 **pureComponent** 或 **shouldComponentUpdate** 来避免组件的渲染。现在，你可以通过把函数组件包装在 **React.memo** 中来实现相同的功能。

```jsx
const MyComponent = React.memo(function MyComponent(props) {
  /* only rerenders if props change */
});
```

### React lazy 函数是什么?

使用 React.lazy 函数允许你将动态导入的组件作为常规组件进行渲染。当组件开始渲染时，它会自动加载包含 OtherComponent 的包。它必须返回一个 Promise，该 Promise 解析后为一个带有默认导出 React 组件的模块。

```jsx
const OtherComponent = React.lazy(() => import('./OtherComponent'));

function MyComponent() {
  return (
    <div>
      <OtherComponent />
    </div>
  );
}
```

**注意：** React.lazy 和 Suspense 还不能用于服务端渲染。如果要在服务端渲染的应用程序中进行代码拆分，我们仍然建议使用 React Loadable。

### 如何在 React 类中使用类字段声明语法?

使用类字段声明可以使 React 类组件更加简洁。你可以在不使用构造函数的情况下初始化本地状态，并通过使用箭头函数声明类方法，而无需额外对它们进行绑定。让我们以一个 counter 示例来演示类字段声明，即不使用构造函数初始化状态且不进行方法绑定：

```jsx
class Counter extends Component {
  state = { value: 0 };

  handleIncrement = () => {
    this.setState(prevState => ({
      value: prevState.value + 1,
    }));
  };

  handleDecrement = () => {
    this.setState(prevState => ({
      value: prevState.value - 1,
    }));
  };

  render() {
    return (
      <div>
        {this.state.value}

        <button onClick={this.handleIncrement}>+</button>
        <button onClick={this.handleDecrement}>-</button>
      </div>
    );
  }
}
```

### 核心架构

- O(n) 复杂度的的 diff 算法。
  > ![](https://wire.cdn-go.cn/wire-cdn/b23befc0/blog/images/react-diff.png)
  > React 通过 updateDepth 对 Virtual DOM 树进行层级控制，只会对相同颜色方框内的 DOM 节点进行比较，即同一个父节点下的所有子节点。当发现节点已经不存在，则该节点及其子节点会被完全删除掉，不会用于进一步的比较。这样只需要对树进行一次遍历，便能完成整个 DOM 树的比较。
  > [详细学习](https://blog.csdn.net/u011413061/article/details/77823299)
- react 的生命周期
  ![react-lifecycle.png](https://wire.cdn-go.cn/wire-cdn/b23befc0/blog/images/react-lifecycle.png)
- setState 实现机制

### react 项目中的`registerServiceWorker.js`文件是做什么的？

默认情况下，React 会为你创建一个没有任何配置的 service worker。Service worker 是一个 Web API，它帮助你缓存资源和其他文件，以便当用户离线或在弱网络时，他/她仍然可以在屏幕上看到结果，因此，它可以帮助你建立更好的用户体验，这是你目前应该了解的关于 Service worker 的内容。

```jsx
import React from 'react';
import ReactDOM from 'react-dom';
import App from './App';
import registerServiceWorker from './registerServiceWorker';

ReactDOM.render(<App />, document.getElementById('root'));
registerServiceWorker();
```

在生产中，我们注册一个服务工作者来从本地缓存服务资产。
这使得应用程序在以后的产品访问中加载速度更快，并使其具备离线功能。但是，这也意味着开发人员(和用户)将只看到在“N+1”访问页面时部署的更新，因为以前缓存的资源在后台更新。

也就是实现 PWA。

### UI 库中的 theme 主题是怎么实现的？

添加默认主题只需要在项目的根目录所在文件`App.js`中使用`createTheme()`方法创建主题,然后将创建的主题通过`ThemeProvider`装饰器传递给整个 APP 的子元素，我们通过改变`ThemeProvider`的`theme`属性的值来改变主题

### react 面试题

- mixin、hoc、render props、react-hooks 的优劣如何？
- 你是如何理解 fiber 的?
- 你对 Time Slice 的理解?
- react-redux 是如何工作的?
- redux 与 mobx 的区别?
- redux 异步中间件之间的优劣?
- redux 中如何进行异步操作?
- React 如何进行组件/逻辑复用?

### React 其他

- 为什么要绑定 this
- setState 是同步还是异步，立即获取值的操作
- hooks
- diff 原理
- fiber
- mobx content 以及 redux 几种状态管理的区别

#### 主要

- 异步渲染
- 事件系统
- fiber
