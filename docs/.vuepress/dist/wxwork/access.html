<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>TBP 企业微信服务号接入指引 | yiliang blog</title>
    <meta name="description" content="开放腾讯核心智能对话系统技术，提供人机交互应用开发最佳体验">
    
    
    <link rel="preload" href="/document/assets/css/0.styles.2ba821d7.css" as="style"><link rel="preload" href="/document/assets/js/app.5ef7bbe5.js" as="script"><link rel="preload" href="/document/assets/js/2.87b3b906.js" as="script"><link rel="preload" href="/document/assets/js/11.ba749f2d.js" as="script"><link rel="prefetch" href="/document/assets/js/10.0ab90938.js"><link rel="prefetch" href="/document/assets/js/12.1c9a952b.js"><link rel="prefetch" href="/document/assets/js/3.ee0b81aa.js"><link rel="prefetch" href="/document/assets/js/4.328c7ac3.js"><link rel="prefetch" href="/document/assets/js/5.50d10a31.js"><link rel="prefetch" href="/document/assets/js/6.b4c4fd2b.js"><link rel="prefetch" href="/document/assets/js/7.1d0a726d.js"><link rel="prefetch" href="/document/assets/js/8.82ccd5f4.js"><link rel="prefetch" href="/document/assets/js/9.792878ee.js">
    <link rel="stylesheet" href="/document/assets/css/0.styles.2ba821d7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/document/" class="home-link router-link-active"><img src="/document/assets/img/logo.jpg" alt="yiliang blog" class="logo"> <span class="site-name can-hide">yiliang blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/document/" class="nav-link">首页</a></div><div class="nav-item"><a href="/document/guide/" class="nav-link">引导</a></div><div class="nav-item"><a href="/document/sdk.html" class="nav-link">SDK</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/document/" class="nav-link">首页</a></div><div class="nav-item"><a href="/document/guide/" class="nav-link">引导</a></div><div class="nav-item"><a href="/document/sdk.html" class="nav-link">SDK</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/document/task/task-bot.html" class="sidebar-link">创建一个任务型机器人</a></li><li><a href="/document/qa/qa-bot.html" class="sidebar-link">创建一个 QA 问答型机器人</a></li><li><a href="/document/wxwork/access.html" class="active sidebar-link">TBP 企业微信服务号接入指引</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/document/wxwork/access.html#_1-概述" class="sidebar-link">1. 概述</a></li><li class="sidebar-sub-header"><a href="/document/wxwork/access.html#_2-前提条件" class="sidebar-link">2. 前提条件</a></li><li class="sidebar-sub-header"><a href="/document/wxwork/access.html#_3-步骤" class="sidebar-link">3. 步骤</a></li><li class="sidebar-sub-header"><a href="/document/wxwork/access.html#_4-企业微信服务号命名规范" class="sidebar-link">4. 企业微信服务号命名规范</a></li><li class="sidebar-sub-header"><a href="/document/wxwork/access.html#_5-联系我们" class="sidebar-link">5. 联系我们</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="tbp-企业微信服务号接入指引"><a href="#tbp-企业微信服务号接入指引" class="header-anchor">#</a> TBP 企业微信服务号接入指引</h1> <p>Author:stevinpan</p> <p>Version:<code>11/8/2019 5:16:36 PM</code></p> <h2 id="_1-概述"><a href="#_1-概述" class="header-anchor">#</a> 1. 概述</h2> <p>TBP 服务支持企业微信服务号接入，接入 TBP 服务后的企业微信服务号，可以响应对话请求，实现自动问答功能。</p> <h2 id="_2-前提条件"><a href="#_2-前提条件" class="header-anchor">#</a> 2. 前提条件</h2> <ol><li>用户拥有腾讯云账号，已经开通 TBP 服务。</li> <li>登录 TBP 官网 <a href="http://tbp.qq.com/" target="_blank" rel="noopener noreferrer">http://tbp.qq.com/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ol> <h2 id="_3-步骤"><a href="#_3-步骤" class="header-anchor">#</a> 3. 步骤</h2> <h3 id="_3-1-新建-bot"><a href="#_3-1-新建-bot" class="header-anchor">#</a> 3.1 新建 Bot</h3> <ol><li>点击按钮后，输入名称即可新建 Bot，如图所示：</li></ol> <p><img src="https://i.imgur.com/OooFNek.jpg" alt=""></p> <ol start="2"><li>新建完成后，点击配置按钮，进入配置界面，如图所示：</li></ol> <p><img src="https://i.imgur.com/2hfMbdT.jpg" alt=""></p> <h3 id="_3-2-配置-bot"><a href="#_3-2-配置-bot" class="header-anchor">#</a> 3.2 配置 Bot</h3> <h4 id="_3-2-1-bot-信息的配置"><a href="#_3-2-1-bot-信息的配置" class="header-anchor">#</a> 3.2.1 Bot 信息的配置</h4> <p>在 Bot 信息配置界面，可以预览 Bot 的基本信息，可以开启/关闭闲聊，可以自定义兜底话术，如图所示：</p> <blockquote><p>“基本信息”部分：展示了当前 Bot 的名称、BotId、状态、时间等。</p> <p>“兜底”部分：当对话过程中的输入未能命中预设的用户说法时，会返回兜底话术，该兜底话术用户可配置。</p> <p>“闲聊”部分：如果用户未开启闲聊，且对话过程中的输入未命中预设的用户说法，则会直接返回兜底话术；如果用户开启了闲聊，且对话过程中的输入未命中预设的用户说法，则此时会尝试命中闲聊型机器人。</p></blockquote> <p><img src="https://i.imgur.com/zinDlGh.jpg" alt=""></p> <h4 id="_3-2-2-问答管理"><a href="#_3-2-2-问答管理" class="header-anchor">#</a> 3.2.2 问答管理</h4> <p>在问答管理界面，用户可以预先配置问答对。</p> <ol><li>新建问答分类，如图所示：
<blockquote><p>在新建问答之前，用户可以创建自己的问答分类；如果没有创建问答分类，则会使用默认分类</p></blockquote></li></ol> <p><img src="https://i.imgur.com/cvx91cZ.jpg" alt=""></p> <ol start="2"><li>新建问答对，如图所示：
<blockquote><p>在指定问答分类下新建问答对，分别输入标准问题、答案，可以选择是否输入相似问题；输入完毕后，点击“保存”或“保存并继续新建”即可。注意，同一个 Bot 下，标准问题不能完全重复。</p></blockquote></li></ol> <p><img src="https://i.imgur.com/Ub4Sqjm.jpg" alt=""></p> <p><img src="https://i.imgur.com/GvQVGCO.jpg" alt=""></p> <ol start="3"><li>按照上一步的逻辑，完成其它问答分类或问答对的创建，如图所示：</li></ol> <p><img src="https://i.imgur.com/XDeiYkN.jpg" alt=""></p> <ol start="4"><li>在新建问答对过程中，也可以选择批量上传。点击“批量上传”按钮，能看到系统提供的上传模板，按模板录入问答对即可。如图所示：</li></ol> <p><img src="https://i.imgur.com/hviWjJV.jpg" alt=""></p> <h3 id="_3-3-控制台初步测试"><a href="#_3-3-控制台初步测试" class="header-anchor">#</a> 3.3 控制台初步测试</h3> <p>TBP 控制台提供对话测试窗口，方便用户测试，点击“测试”按钮即可展开测试窗口，输入预设的用户说法即可测试，如图所示：</p> <p><img src="https://i.imgur.com/yvEwnhY.jpg" alt=""></p> <p><img src="https://i.imgur.com/PC0gSgr.jpg" alt=""></p> <h3 id="_3-4-发布管理"><a href="#_3-4-发布管理" class="header-anchor">#</a> 3.4 发布管理</h3> <p>在“发布管理”界面，可以看到当前 Bot 的调试版本 ID 和线上版本 ID。点击“发布上线”操作，将当前调试版本发布到线上；点击“下线”操作，将当前线上版本下线。如图所示：</p> <p><img src="https://i.imgur.com/sGyCIMF.jpg" alt=""></p> <blockquote><p><strong>特别注意</strong>：控制台测试界面调用的是当前 Bot 的调试版本，其他第三方应用接入如“微信公众号”、“企业微信服务号”、“微信小程序”等均使用的是线上版本。Bot 的每一次修改、保存均会生成新的调试版本 ID，只有手动进行“发布上线”操作，才能在接入的第三方应用中体验最新配置的 Bot 功能。</p></blockquote> <h3 id="_3-5-企业微信服务号接入"><a href="#_3-5-企业微信服务号接入" class="header-anchor">#</a> 3.5 企业微信服务号接入</h3> <ol><li>在“应用接入”界面，设置腾讯云 API 密钥，如图所示：
<blockquote><p>注意，该密钥为当前 Bot 所属账户的密钥，用于通过公有云调用该密钥账户下的 Bot。</p></blockquote></li></ol> <p><img src="https://i.imgur.com/6uzLNlz.jpg" alt=""></p> <ol start="2"><li>设置完 API 密钥后，点击“企业微信”模块的“接入设置”，进入配置界面，如图所示：</li></ol> <p><img src="https://i.imgur.com/j73fn7B.jpg" alt=""></p> <ol start="3"><li>配置分为三步：申请企业微信服务号、填写接口调用凭证、配置人工客服 ID
<blockquote><ol><li>填写企业微信服务号：根据平台自动生成的回调 URL、Token、EncodingAESKey，复制该部分信息，在企业微信开放平台按“02 自动回复+人工的客服”模式申请客服号，如图所示：
<img src="https://i.imgur.com/eEUMY8J.jpg" alt=""></li> <li>填写接口调用凭证：申请服务号成功后，会收到企业微信团队的回复邮件，邮件中有“服务 id”、“corpid”、“接口 secret”，依次填入如下配置页面即可，如图所示：
<img src="https://i.imgur.com/tpNrJEd.jpg" alt=""></li> <li>配置人工客服 ID：在该部分配置界面，填写人工客服 id，当用户在会话窗口输入“人工”等字样时，会自动将创建群聊。如图所示：
<img src="https://i.imgur.com/D6pqcdp.jpg" alt=""></li></ol> <p><strong>注意</strong>：当将 helper 配置为人工客服时，不能填写 helper 的 RTX，只能填写 helper 的 serviceId，具体 helper 对应的 serviceId 可在此查阅<a href="http://km.oa.com/articles/show/393423" target="_blank" rel="noopener noreferrer">http://km.oa.com/articles/show/393423<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote></li> <li>如果用户已经有服务号，则也可以按上一步的流程，复制回调 URL、Token、EncodingAESKey，并发邮件给企业微信团队，将服务号更改为“02 自动回复+人工的客服”模式</li></ol> <h3 id="_3-6-测试企业微信服务号"><a href="#_3-6-测试企业微信服务号" class="header-anchor">#</a> 3.6 测试企业微信服务号</h3> <p>在企业微信中找到对应的服务号，进行会话即可。企业微信服务号分为单聊模式和群聊模式，根据聊天模式的不同，TBP 平台提供有差异的功能。</p> <h4 id="_3-6-1-单聊模式"><a href="#_3-6-1-单聊模式" class="header-anchor">#</a> 3.6.1 单聊模式</h4> <p>“单聊模式”即用户点击服务号的聊天窗口，进行一对一的聊天模式。</p> <ol><li>在单聊模式中，输入相关问题即可得到服务号的响应。如果此时已经精准命中问题，则会同时返回“有用”、“无用”选项，支持用户点击以便对答案进行反馈。如图所示：</li></ol> <p><img src="https://i.imgur.com/SH5kB2U.jpg" alt=""></p> <ol start="2"><li>输入“人工”相关字眼，即可将人工客服拉群。</li></ol> <p><img src="https://i.imgur.com/Vz1kKzd.jpg" alt=""></p> <p><img src="https://i.imgur.com/LrgMpst.jpg" alt=""></p> <h4 id="_3-6-2-群聊模式"><a href="#_3-6-2-群聊模式" class="header-anchor">#</a> 3.6.2 群聊模式</h4> <ol><li>群聊模式下，服务号只有被单独@(@所有人除外)才<strong>有可能</strong>会自动回复：如果用户输入能匹配上预设的问题，或者存在对应的相似问题，则服务号会自动回复；否则，服务号不会自动回复。同时，在返回相似问题列表时，也支持直接回复对应数字。如图所示：</li></ol> <p><img src="https://i.imgur.com/WB8mYDU.jpg" alt=""></p> <ol start="2"><li>如果人工客服不在当前群聊中，输入“人工”字样并@服务号时，会拉预设的人工客服入群；如果人工客服已经在当前群聊中，输入“人工”字样并@服务号时，则会出现提示消息，如图所示：</li></ol> <p><img src="https://i.imgur.com/DWgC9g4.jpg" alt=""></p> <h2 id="_4-企业微信服务号命名规范"><a href="#_4-企业微信服务号命名规范" class="header-anchor">#</a> 4. 企业微信服务号命名规范</h2> <p>企业微信服务号的命名很重要，规范的命名可以使得服务号在企业微信中被有效搜索到；如果命名不规范，一方面可能会导致难以被搜索到，另一方面可能会被误认为是其他团队的服务号、引起困扰或纠纷等。TBP 团队对企业微信服务号的命名有如下建议：</p> <ol><li><p>服务号由“名称”+“备注”组成</p> <ol><li>“名称”建议采用全英文、分等级的命名方式。全英文是指采用英文单词或单词缩写来组成命名；分等级是指名称由多部分构成，第一部分表示所属部门，第二部分表示对应产品，最后一部分以“helper”结尾，各部分之间以“-”分隔，如“BigData-TBP-helper”</li> <li>“备注”是对该服务号功能的简短介绍，一般以中文描述为主。</li> <li>Example：BigData-TBP-helper(TBP 服务助手)</li></ol></li> <li><p>服务号的名称或备注里，均不应该包含其他团队产品的关键字，以免在企业微信中搜索时引起误会。如“TBP”表示腾讯只能对话平台，其他服务号在命名过程中应该避免出现该关键字。</p></li></ol> <h2 id="_5-联系我们"><a href="#_5-联系我们" class="header-anchor">#</a> 5. 联系我们</h2> <ol><li>产品咨询或合作洽谈相关，请优先联系 elinaliu；</li> <li>功能反馈或接入疑问相关，请优先联系 stevinpan。</li></ol></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/document/qa/qa-bot.html" class="prev">创建一个 QA 问答型机器人</a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/document/assets/js/app.5ef7bbe5.js" defer></script><script src="/document/assets/js/2.87b3b906.js" defer></script><script src="/document/assets/js/11.ba749f2d.js" defer></script>
  </body>
</html>
