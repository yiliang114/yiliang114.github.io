---
layout: CustomPages
title: Network
date: 2020-11-21
aside: false
draft: true
---

### 实现浏览器内多个标签页之间的通信

- 可以调用 localStorage, cookies 等本地存储方式；
- localStorage 另一个浏览上下文里被添加、修改或删除时，它都会触发一个事件，我们通过监听事件，控制它的值来进行页面信息通信；监听 window.onstorage。
  1. 重复写入相同的值无法触发。
  2. 会受到浏览器隐身模式等的限制
- 注意 quirks： Safari 在无痕模式下设置 localStorage 值时会抛出 QuotaExceededError 的异常；
- iframe + contentWindow
- 通过父页面 window.open()和子页面 postMessage
- SharedWorker(Web Worker API)
- storage 事件(localStorage API)
- 借助服务端或者中间层实现

### WEB 应用从服务器主动推送 Data 到客户端有那些方式？

1. html5 websocket
2. WebSocket 通过 Flash
3. XHR 长时间连接
4. XHR Multipart Streaming
5. 不可见的 Iframe
6. script 标签的长时间连接(可跨域)

### 什么是一级域名，什么是二级域名，什么是三级域名

通俗的解释：baidu.com 是一级域名，zhidao.baidu.com 是二级域名。www.baidu.com 是域名 baidu.com 的一个二级域名，只不过是一个比较特殊的二级域名罢了。他的特殊就在于现在的实践中，人们在解析域名的的时候，在惯例和默认的情况下，是把 www.baidu.com 这个二级域名指向它的一级域名 baidu.com。因此，现在的大部分情况下，baidu.com 和 www.baidu.com，都是一样的，有和没有 www 一般没有关系。

#### 原理

为什么大都数网站打开二级域名 www.baidu.com 和打开一级域名 baidu.com 是一样的，其实是把两个域名都解析到了同一个 IP 或期中的一个做了 301 中转。这样做的目的是符合网民的使用习惯，有利于网站的权重集中。

### 服务器辨别用户

- session
- cookie

### 网络分层七层模型

- 应用层：应用层、表示层、会话层（从上往下）（`HTTP、FTP、SMTP、DNS`）
- 传输层（`TCP`和`UDP`）
- 网络层（`IP`）
- 物理和数据链路层（以太网）

### OSI，TCP/IP，五层协议的体系结构

OSI 分层 （7 层）：物理层、数据链路层、网络层、传输层、会话层、表示层、应用层。
TCP/IP 分层（4 层）：网络接口层、 网际层、运输层、 应用层。
五层协议 （5 层）：物理层、数据链路层、网络层、运输层、 应用层。

#### 每一层的协议

物理层：RJ45、CLOCK、IEEE802.3 （中继器，集线器）
数据链路：PPP、FR、HDLC、VLAN、MAC （网桥，交换机）
网络层：IP、ICMP、ARP、RARP、OSPF、IPX、RIP、IGRP、 （路由器）
传输层：TCP、UDP、SPX
会话层：NFS、SQL、NETBIOS、RPC
表示层：JPEG、MPEG、ASII
应用层：FTP、DNS、Telnet、SMTP、HTTP、WWW、NFS

#### 每一层的作用如下

- 物理层：通过媒介传输比特,确定机械及电气规范（比特 Bit）传输介质相关
- 数据链路层：将比特组装成帧和点到点的传递（帧 Frame）定义单个链路上如何传输数据
- 网络层：负责数据包从源到宿的传递和网际互连（包 PackeT）端到端包传输，路由选择、包分解成更小的包
- 传输层：提供端到端的可靠报文传递和错误恢复（段 Segment）选择差错恢复协议还是无差错恢复协议，TCP、UDP
- 会话层：建立、管理和终止会话（会话协议数据单元 SPDU）定义了如何开始、控制、结束一个会话，包括对多个双向消息的控制和管理
- 表示层：对数据进行翻译、加密和压缩（表示协议数据单元 PPDU）定义数据格式以及加密
- 应用层：允许访问 OSI 环境的手段（应用协议数据单元 APDU）为应用提供通信服务

### IP 地址的分类

其中 A、B、C 是基本类，D、E 类作为多播和保留使用。

- A 类地址：以 0 开头， 第一个字节范围：1~127（1.0.0.0 - 127.255.255.255）；
- B 类地址：以 10 开头， 第一个字节范围：128~191（128.0.0.0 - 191.255.255.255）；
- C 类地址：以 110 开头， 第一个字节范围：192~223（192.0.0.0 - 223.255.255.255）；
- D 类地址：以 1110 开头，第一个字节范围：224~239（224.0.0.0 - 239.255.255.255）；（作为多播使用）
- E 类地址：保留

在 IP 地址 3 种主要类型里，各保留了 3 个区域作为私有地址，其地址范围如下：

- A 类地址：10.0.0.0 ～ 10.255.255.255
- B 类地址：172.16.0.0 ～ 172.31.255.255
- C 类地址：192.168.0.0 ～ 192.168.255.255

### 端口号的作用是什么？

主要是区分服务类别和在同一时间进行多个会话。

### 各种协议的介绍

ICMP 协议： 因特网控制报文协议。它是 TCP/IP 协议族的一个子协议，用于在 IP 主机、路由器之间传递控制消息。
TFTP 协议： 是 TCP/IP 协议族中的一个用来在客户机与服务器之间进行简单文件传输的协议，提供不复杂、开销不大的文件传输服务。
HTTP 协议： 超文本传输协议，是一个属于应用层的面向对象的协议，由于其简捷、快速的方式，适用于分布式超媒体信息系统。
NAT 协议：网络地址转换属接入广域网(WAN)技术，是一种将私有（保留）地址转化为合法 IP 地址的转换技术，
DHCP 协议：动态主机配置协议，是一种让系统得以连接到网络上，并获取所需要的配置参数手段，使用 UDP 协议工作。具体用途：给内部网络或网络供应商自动分配 IP 地址，给用户或者内部网络管理员作为对所有计算机作中央管理的手段

- `ICMP协议`： 因特网控制报文协议。它是 TCP/IP 协议族的一个子协议，用于在 IP 主机、路由器之间传递控制消息。
- `TFTP协议`： 是 TCP/IP 协议族中的一个用来在客户机与服务器之间进行简单文件传输的协议，提供不复杂、开销不大的文件传输服务。
- `HTTP协议`： 超文本传输协议，是一个属于应用层的面向对象的协议，由于其简捷、快速的方式，适用于分布式超媒体信息系统。
- `DHCP协议`： 动态主机配置协议，是一种让系统得以连接到网络上，并获取所需要的配置参数手段。

### 了解交换机、路由器、网关的概念，并知道各自的用途

#### 交换机

在计算机网络系统中，交换机是针对共享工作模式的弱点而推出的。交换机拥有一条高带宽的背部总线和内部交换矩阵。交换机的所有的端口都挂接在这条背 部总线上，当控制电路收到数据包以后，处理端口会查找内存中的地址对照表以确定目的 MAC（网卡的硬件地址）的 NIC（网卡）挂接在哪个端口上，通过内部 交换矩阵迅速将数据包传送到目的端口。目的 MAC 若不存在，交换机才广播到所有的端口，接收端口回应后交换机会“学习”新的地址，并把它添加入内部地址表 中。
交换机工作于 OSI 参考模型的第二层，即数据链路层。交换机内部的 CPU 会在每个端口成功连接时，通过 ARP 协议学习它的 MAC 地址，保存成一张 ARP 表。在今后的通讯中，发往该 MAC 地址的数据包将仅送往其对应的端口，而不是所有的端口。因此，交换机可用于划分数据链路层广播，即冲突域；但它不 能划分网络层广播，即广播域。
交换机被广泛应用于二层网络交换，俗称“二层交换机”。
交换机的种类有：二层交换机、三层交换机、四层交换机、七层交换机分别工作在 OSI 七层模型中的第二层、第三层、第四层盒第七层，并因此而得名。

#### 路由器

路由器（Router）是一种计算机网络设备，提供了路由与转送两种重要机制，可以决定数据包从来源端到目的端所经过 的路由路径（host 到 host 之间的传输路径），这个过程称为路由；将路由器输入端的数据包移送至适当的路由器输出端(在路由器内部进行)，这称为转 送。路由工作在 OSI 模型的第三层——即网络层，例如网际协议。
路由器的一个作用是连通不同的网络，另一个作用是选择信息传送的线路。 路由器与交换器的差别，路由器是属于 OSI 第三层的产品，交换器是 OSI 第二层的产品(这里特指二层交换机)。

#### 网关

网关（Gateway），网关顾名思义就是连接两个网络的设备，区别于路由器（由于历史的原因，许多有关 TCP/IP 的文献曾经把网络层使用的路由器（Router）称为网关，在今天很多局域网采用都是路由来接入网络，因此现在通常指的网关就是路由器的 IP），经常在家 庭中或者小型企业网络中使用，用于连接局域网和 Internet。 网关也经常指把一种协议转成另一种协议的设备，比如语音网关。
在传统 TCP/IP 术语中，网络设备只分成两种，一种为网关（gateway），另一种为主机（host）。网关能在网络间转递数据包，但主机不能 转送数据包。在主机（又称终端系统，end system）中，数据包需经过 TCP/IP 四层协议处理，但是在网关（又称中介系 统，intermediate system）只需要到达网际层（Internet layer），决定路径之后就可以转送。在当时，网关 （gateway）与路由器（router）还没有区别。
在现代网络术语中，网关（gateway）与路由器（router）的定义不同。网关（gateway）能在不同协议间移动数据，而路由器（router）是在不同网络间移动数据，相当于传统所说的 IP 网关（IP gateway）。
网关是连接两个网络的设备，对于语音网关来说，他可以连接 PSTN 网络和以太网，这就相当于 VOIP，把不同电话中的模拟信号通过网关而转换成数字信号，而且加入协议再去传输。在到了接收端的时候再通过网关还原成模拟的电话信号，最后才能在电话机上听到。
对于以太网中的网关只能转发三层以上数据包，这一点和路由是一样的。而不同的是网关中并没有路由表，他只能按照预先设定的不同网段来进行转发。网关最重要的一点就是端口映射，子网内用户在外网看来只是外网的 IP 地址对应着不同的端口，这样看来就会保护子网内的用户。

### 如何对音频和视频资源进行预加载

### 其他

- cookie 与 session 的区别? 服务端如何清除 cookie?
- `TIME_WAIT` 是什么情况? 出现过多的 `TIME_WAIT` 可能是什么原因?
- hosts 文件是什么? 什么叫 DNS 本地解析?
- 列举几个提高网络传输速度的办法?
