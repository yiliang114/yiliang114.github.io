---
title: mobile
date: 2020-11-21
draft: true
---

<!-- TODO: -->

## 移动端 h5 专栏

- position: fixed 导致的 onClick 事件透传到底下被遮住的部分。怎么解决？ 移动端 fixed 布局键盘弹出的问题。
- 点击延迟
- 一份视觉稿如何适配多个机型的设备(大漠老师的文章和 seven 的文章)
- css 单位的好处
- scroll 和 iScroll 的作用以及效果
- 无限下拉的时候如何实现懒加载，并且如何保证 vuex 之类的堆栈不会爆掉(或者保持一定的速度)
- viewport， touch 事件、方向检测， 终端类型、浏览器类型检测

- 谈谈对移动端开发的理解吧。
  最显著的，是尺寸的差异。其次是触控方式的差别，移动端有一系列以 touch 开头的事件。还有要注意优化性能和加载速度，因为移动端一般不能多任务，用户可能没有那么耐心，设备性能也不能跟 pc 比。

- 移动端高清方案如何解决 ?
- JSBridge 原理, js 和 native 是如何通信的?
- 移动端如何优化首页白屏时间过长 ?

- iScroll 插件，上下拉动有回弹效果？

### 移动 web 开发与 PC web 开发的区别有哪些？

### 移动 web 开发中 css 常用的单位有哪些？

移动 web 开发中的 css 单位除了 PC web 开发常见的 px、em、百分比，还有 rem、vh、vw，rem 类似于 em，是一个相对字体大小，
不过 rem 相对的是根元素的字体大小，vw 和 vh 是相对于 viewport 的宽高，这两个单位将 viewport 等分为 100 份，也就是说 1vw
相当于 viewport 宽度的百分之一。

### 常见的移动端事件有哪些？

### 移动端项目需要注意的 4 个问题

#### meta 中设置 viewport

阻止用户手滑放大或缩小页面，需要在 index.html 中添加 meta 元素,设置 viewport。

```html
<meta
  name="viewport"
  content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"
/>
```

#### CSS 样式统一问题

我们需要重置页面样式，因为在不同的手机浏览器上，默认的 css 样式不是统一的。 解决方法：使用 reset.css 重置所有元素的默认样式

#### 一像素边框问题

有的手机分辨率比较高，是 2 倍屏或 3 倍屏，手机上的浏览器就会把 CSS 中的 1 像素值展示为 2 个或 3 个物理宽度 解决方法： 添加一个 border.css 库，将利用**scroll 缩放的原理**将边框重置。当我们需要使用一像素边框时只需要在标签上添加对应类名，如设置底部一像素边框就在标签上加入"border-bottom"的 class 名

#### 300 毫秒点击延迟问题

在移动端开发中，某些机型上使用 click 事件会延迟 300ms 才执行，这样影响了用户体验。 解决方法： 引入[fastclick.js](https://www.jianshu.com/p/05b142d84780)。

- 媒体查询
- 移动端高清方案
- 移动端响应式布局 https://zhuanlan.zhihu.com/p/29351955

#### 移动端性能优化

- 尽量使用 css3 动画，开启硬件加速。
- 适当使用`touch`事件代替`click`事件。
- 避免使用`css3`渐变阴影效果。
- 可以用`transform: translateZ(0)`来开启硬件加速。
- 不滥用 Float。Float 在渲染时计算量比较大，尽量减少使用
- 不滥用 Web 字体。Web 字体需要下载，解析，重绘当前页面，尽量减少使用。
- 合理使用 requestAnimationFrame 动画代替 setTimeout
- CSS 中的属性（CSS3 transitions、CSS3 3D transforms、Opacity、Canvas、WebGL、Video）会触发 GPU 渲染，请合理使用。过渡使用会引发手机过耗电增加
- PC 端的在移动端同样适用

### 滚动

- 移动端如何进行调试
- 移动端和 pc 端和微信兼容性问题
- 移动端的适配，rem + 媒体查询 或者 meta 头设置
- click 在 ios 上有 300ms 的延迟，原因以及解决方式
- 如何做移动端布局的兼容，考虑安卓 4.4 或者更低版本
- 移动端输入框被键盘遮挡处理：
  https://www.one-tab.com/page/0lfPEmLgTUah0UpBVEjuqQ

## hybrid

### hybrid 是什么，为何会使用 hybrid

hybrid 即"混合"，即前端和客户端的混合开发，某些环节也可能涉及 server 端

hybird 存在的核心意义在于快速迭代，无需审核

具体实现：

- 前端做好静态网页，将文件交给客户端
- 客户端拿到前端静态网页，以文件形式存储在 app 中
- 客户端在一个 webview 中
- 使用 file 协议加载静态页面

### 各技术适用场景

- 使用 NativeApp
  - 体验要求极致，变化不频繁
- 使用 hybrid
  - 体验要求高，变化频繁
- 使用 h5 -体验要求低，不常用

### hybrid 存在价值

- 可快速迭代更新
- 体验流畅
- 双端公用一套代码

### webview

- 是 app 中的一个组件。
- 用于加载 h5 页面，即小型浏览器内核
- 只是单纯的展示一个网页界面

### app 发布后，静态文件如何实时更新？

- 将静态文件(html,css,js 等)压缩成包，上传到服务端
- 客户端每次启动，都去服务端检查静态文件发布日期
- 如果服务端发布日期晚与客户端使用资源的发布日期，就去下载最新的压缩包
- 下载完成后解压，将现有文件覆盖

### 移动端布局方案

百分比布局
百分比布局的，这样的做法的话是比较费时间的，有些细节的地方还需要用媒体查询来做兼容。做起来挺费时间，而且对于设计稿的还原也不好。所以这里>也不怎么推荐
固定的设备宽度
在做移动开发的时候很多人都会加上 viewport 的配置，
那么固定设备宽度的布局就是根据这个来设置的，将 viewport 里面的宽度 width 设置成设计稿的宽度，也就是说原本是 width=device-width，即宽度为设备的宽度，假如在 iphone6 上显示的时候，那么页面的宽度就是 375px; 当我们将 width 设置成设计稿的宽度的，假如设计稿是 750px，而我们的 css 也按设计的尺寸来做，例如一个图片是 200px\*200px，那么在 css 上也是宽高都是写 200px,也就是 1：1 的比例。那么在 375px 的手机上显示的时候，就会缩小 2 倍显示，以此类推，在 320px 的宽度的时候，就会缩小 2.3 倍显示，在 414px 的宽度的时候就会缩小 1.8 倍。
这样的写法是会比较好的还原设计稿，而且速度也会比较快，但是这样也有缺点，在缩>小的时候有些设备会比较模糊，因为你强行将设备放大了
rem 布局
我现在常用的移动端布局主要是用 rem 布局，这个应该是比较多人使用的，也是比较流行的。使用 rem 布局优点是可以适应多个屏幕 ，也比较好的还原设计稿。在有些地方需要一屏显示完设计稿的时候，可能需要用到 vh,或是百分比。
rem 布局简单来说就是根据页面的 font-size 的大小来设置页面元素的属性

### 为什么响应式设计 (responsive design) 和自适应设计 (adaptive design) 不同

响应式（RWD
所有设备的代码是一样的,响应式的概念覆盖了自适应，而且涵盖的内容更多
优点：面对不同分辨率设备灵活性强；能够快捷解决多设备显示适应问题
缺点：兼容各种设备工作量大，效率低下；代码累赘会出现隐藏无用的元素，加载时间加长；一定程度上改变了网站原有的布局结构，会出现用户混淆的结果

自适应（AWD
不同设备的代码是不一样的,自适应是为了解决如何在不同大小的设备上呈现同样的网页（网页的主题和内容不改变）
自适应暴露的一个问题，如果屏幕太小，即使网页能够根据屏幕大小进行适配，但是会感觉在小屏幕上查看内容太过拥挤。
响应式正是针对这个问题衍生出的概念。它可以自动识别屏幕宽度、并做出相应调整的网页设计、布局和展示的内容可能会有所改变

自适应设计实现方法： 1.允许网页宽度自动调整
首先在代码的头部加入一行 viewport 标签

viewport 是网页默认的宽度和高度，上面代码的意思是，网页宽度默认等于屏幕宽度，原始缩放比例为 1.0，即网页出事大小占屏幕的 100%。
所有主流浏览器都支持这个设置。对于老式浏览器（主要针对 IE6,7,8），需要使用 css3-mediaqueries.js。

<script src="http://css3-mediaqueries-js.googlecode.com/svn/trunk/css3-mediaqueries.js"></script>

2.尽量少使用绝对宽度
由于网页会根据屏幕宽度调整布局，所以不能使用绝对宽度的布局，也不能使用具有绝对宽度的元素。
具体：如不能使用 px 作为单位，使用百分比，同时可以配合 css 的 cal 进行宽度，或者 width：auto；

3.相对大小的字体
字体也不能使用绝对大小（px），只能使用相对大小（em）或者高清方案（rem），rem 不局限字体大小，而前面的 width 也可以使用，代替百分百。

4.流动布局
流动布局是各个区块的位置都是浮动的，不是固定不变的。
float 的好处是，如果宽度太小，放不下两个元素，后面的元素会自动滚到前面元素的下方，不会再水平方向溢出，避免了水平滚动条的实现。另外绝对定位也要谨慎使用

5.选择加载 css

区别
响应式布局中你可能需要面对非常多状态——是的，大部分状态之间的区别很小，但它们又的确是不同的——这样一来就很难确切搞清你的设计会是什么样
自适应布局有它自己的优势，因为它们实施起来代价更低，测试更容易，这往往让他们成为更切实际的解决方案。自适应布局可以看做响应式布局的“穷兄弟”，在资源有限的情况下就可以让它出马

扩展：
那起飞页是响应式还是自适应呢？这个。。。严格的说，起飞页是自适应的，因为我们针对不同的设备进行了优化和加速。但是不同设备上的代码，又竟然是 90%一致的。我们只能说，起飞页九成是响应式，一成是自适应，是这两种技术的完美结合

### 你有兼容 retina 屏幕的经历吗？如果有，在什么地方使用了何种技术？

retina 是苹果推出的新型屏幕，由 4 个原像素点去描述一个新像素点（即压缩了 2 倍），且存在 0.5 个像素点这样的描述，所以需要兼容。
当一个图像在标准设备下全屏显示时，一位图像素对应的就是一设备像素，导致一个完全保真的显示，因为一个位置像素不能进一步分裂。而当在 Retina 屏幕下时，他要放大四倍来保持相同的物理像素的大小，这样就会丢失很多细节，造成失真的情形。换句话说，每一位图像素被乘以四填补相同的物理表面在视网膜屏幕下显示。

解决方法就是通过制作两种不同的图形，一张是普通屏幕的图片，另外一种是 Retina 屏幕的图形，而且 Retina 屏幕下的图片是普通屏幕的两倍像素

- 直接加载 2 倍大小的图片

```js
<img class="pic" src="pic.png" height="200px" width="300px"/>

<script type="text/javascript">
$(document).ready(function () {
    if (window.devicePixelRatio > 1) {
        var images = $("img.pic");
        images.each(function(i) {
            var x1 = $(this).attr('src');
            var x2 = x1.replace(/(.*)(.w+)/, "$1@2x$2");
            $(this).attr('src', x2);
        });
    }
});
```

- Image-set 控制

```js
#logo {
    background: url(pic.png) 0 0 no-repeat;
    background-image: -webkit-image-set(url(pic.png) 1x, url(pic@2x.png) 2x);
    background-image: -moz-image-set(url(pic.png) 1x,url(images/pic@2x.png) 2x);
    background-image: -ms-image-set(url(pic.png) 1x,url(images/pic@2x.png) 2x);
    background-image: -o-image-set(url(url(pic.png) 1x,url(images/pic@2x.png) 2x);
```

- 使用@media 控制

```js
@media only screen and (-webkit-min-device-pixel-ratio: 1.5),
only screen and (min--moz-device-pixel-ratio: 1.5), /* 注意这里的写法比较特殊 */
only screen and (-o-min-device-pixel-ratio: 3/2),
only screen and (min-device-pixel-ratio: 1.5) {
    #logo {
        background-image: url(pic@2x.png);
        background-size: 100px auto;
    }
}
```

### 你用过媒体查询，或针对移动端的布局/CSS 吗？

媒体查询，就是响应式布局。通过不同的媒介类型和条件定义样式表规则。媒介查询让 CSS 可以更精确作用于不同的媒介类型和同一媒介的不同条件。

语法结构及用法：@media 设备名 only （选取条件） not （选取条件） and（设备选取条件），设备二{sRules}。

```css
/* 当浏览器的可视区域小于980px */
@media screen and （max-width： 980px） {
#wrap {width： 90%; margin:0 auto;}
#content {width： 60%;padding： 5%;}
#sidebar {width： 30%;}
#footer {padding： 8% 5%;margin-bottom： 10px;}
}
/* 当浏览器的可视区域小于650px */
@media screen and （max-width： 650px） {
#header {height： auto;}
#searchform {position： absolute;top： 5px;right： 0;}
#content {width： auto; float： none; margin： 20px 0;}
#sidebar {width： 100%; float： none; margin： 0;}
}
```

### 如何解决移动端 Retina 屏 1px 像素问题

1. 0.5px
2. 使用 border-image 实现
3. 使用 background-image 实现
4. 多背景渐变实现
5. 使用 box-shadow 模拟边框
6. viewport + rem 实现
7. 伪类 + transform 实现

#### 画一条 0.5px 的线

1. 直接设置 0.5px

```html
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <style>
      .hr {
        width: 300px;
        background-color: #000;
      }
      .hr.half-px {
        height: 0.5px;
      }
      .hr.one-px {
        height: 1px;
      }
    </style>
  </head>
  <body>
    <p>0.5px</p>
    <div class="hr half-px"></div>
    <p>1px</p>
    <div class="hr one-px"></div>
  </body>
</html>
```

2. 使用 scale 缩放

```css
.scale-half {
  height: 1px;
  transform: scaleY(0.5);
  background-color: red;
}
```

3. 线性渐变 linear-gradient

```js
<style>
.hr.gradient {
    height: 1px;
    background: linear-gradient(0deg, #fff, #000);
}
</style>
<p>linear-gradient(0deg, #fff, #000)</p>
<div class="hr gradient"></div>
```

4.boxshadow

```js
<style>
.hr.boxshadow {
    height: 1px;
    background: none;
    box-shadow: 0 0.5px 0 #000;
}
</style>
<p>box-shadow: 0 0.5px 0 #000</p>
<div class="hr boxshadow"></div>
```

5.viewport

```js
<meta name="viewport" content="width=device-width,initial-sacle=0.5">
```

#### 实现不使用 border 画出 1px 高的线，在不同浏览器的标准模式与怪异模式下都能保持一致的效果

```html
<div style="height:1px;overflow:hidden;background:red"></div>
```

### 移动端的布局用过媒体查询吗？

- 假设你现在正用一台显示设备来阅读这篇文章，同时你也想把它投影到屏幕上，或者打印出来，而显示设备、屏幕投影和打印等这些媒介都有自己的特点，CSS 就是为文档提供在不同媒介上展示的适配方法

- <!-- link元素中的CSS媒体查询 -->

  - 当媒体查询为真时，相关的样式表或样式规则会按照正常的级联规被应用。
  - 当媒体查询返回假， <link> 标签上带有媒体查询的样式表 仍将被下载 （只不过不会被应用）

- <link rel="stylesheet" media="(max-width: 800px)" href="example.css" />

- <!-- 样式表中的CSS媒体查询 -->

  - 包含了一个媒体类型和至少一个使用 宽度、高度和颜色等媒体属性来限制样式表范围的表达式
  - CSS3 加入的媒体查询使得无需修改内容便可以使样式应用于某些特定的设备范围

```
<style>
@media (min-width: 700px) and (orientation: landscape){
  .sidebar {
    display: none;
  }
}
</style>
```

### 什么是响应式设计？响应式设计的基本原理是什么？如何兼容低版本的 IE？

- 响应式设计就是网站能够兼容多个终端，而不是为每个终端做一个特定的版本
- 基本原理是利用 CSS3 媒体查询，为不同尺寸的设备适配不同样式
- 对于低版本的 IE，可采用 JS 获取屏幕宽度，然后通过 resize 方法来实现兼容：

```js
$(window).resize(function() {
  screenRespond();
});
screenRespond();
function screenRespond() {
  var screenWidth = $(window).width();
  if (screenWidth <= 1800) {
    $('body').attr('class', 'w1800');
  }
  if (screenWidth <= 1400) {
    $('body').attr('class', 'w1400');
  }
  if (screenWidth > 1800) {
    $('body').attr('class', '');
  }
}
```

### 让页面里的字体变清晰，变细用 CSS 怎么做？（IOS 手机浏览器字体齿轮设置）

```css
-webkit-font-smoothing: antialiased;
```

### 移动端

- position： fixed 在安卓中无效怎么处理
- 高清处理

### 你是否使用过媒体查询或移动优先的布局？

是的，一个例子就是根据窗口的尺寸改变导航的样式。

### 你有没有使用过视网膜分辨率的图形？当中使用什么技术？

我倾向于使用更高分辨率的图形（显示尺寸的两倍）来处理视网膜显示。更好的方法是使用媒体查询，像`@media only screen and (min-device-pixel-ratio: 2) { ... }`，然后改变`background-image`。

对于图标类的图形，我会尽可能使用 svg 和图标字体，因为它们在任何分辨率下，都能被渲染得十分清晰。

还有一种方法是，在检查了`window.devicePixelRatio`的值后，利用 JavaScript 将`<img>`的`src`属性修改，用更高分辨率的版本进行替换。

### 响应式设计与自适应设计有何不同？

响应式设计和自适应设计都以提高不同设备间的用户体验为目标，根据视窗大小、分辨率、使用环境和控制方式等参数进行优化调整。

响应式设计的适应性原则：网站应该凭借一份代码，在各种设备上都有良好的显示和使用效果。响应式网站通过使用媒体查询，自适应栅格和响应式图片，基于多种因素进行变化，创造出优良的用户体验。就像一个球通过膨胀和收缩，来适应不同大小的篮圈。

自适应设计更像是渐进式增强的现代解释。与响应式设计单一地去适配不同，自适应设计通过检测设备和其他特征，从早已定义好的一系列视窗大小和其他特性中，选出最恰当的功能和布局。与使用一个球去穿过各种的篮筐不同，自适应设计允许使用多个球，然后根据不同的篮筐大小，去选择最合适的一个。

### 你用过栅格系统 (grid system) 吗？如果使用过，你最喜欢哪种？

`float`-based 栅格系统，因为它相比 flex、grid 系统，拥有更多浏览器的支持。它已经在 Bootstrap 中使用多年，并且已经被证明是可行的。

Bootstrap 中的流式布局；Bootstrap 提供了两种布局方式，固定式布局和流式布局（用 em 表示的叫做弹性布局，用百分比表示的叫做流体布局）方式，Bootstrap 的布局实际上是在栅格外加个容器 (Container)
因此两种布局方式的唯一区别是：
固定布局加的是固定宽度(width)的容器，
流式布局加的是自适应(或叫可变)宽度的容器。

### 移动端的点击事件的延迟时间是多长，为什么会有延迟？ 如何解决这个延时？

- 移动端 click 有 300ms 延迟，浏览器为了区分“双击”（放大页面）还是“单击”而设计
- 解决方案：
  - 禁用缩放(对 safari 无效)
  - 使用指针事件(IE 私有特性，且仅 IE10+)
  - 使用 Zepto 的 tap 事件(有点透 BUG)
  - 使用 FastClick 插件(体积大[压缩后 8k])

### position:fixed;在 android 下无效怎么处理？

- fixed 的元素是相对整个页面固定位置的，你在屏幕上滑动只是在移动这个所谓的 viewport，原来的网页还好好的在那，fixed 的内容也没有变过位置，
- 所以说并不是 iOS 不支持 fixed，只是 fixed 的元素不是相对手机屏幕固定的
- `<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no"/>`

### 媒体查询的原理是什么？

### 页面上一个可以触摸的方块，如何让其跟着这手指的移动而移动？手机触屏事件了解多少？

### 手机触屏事件

| 事件        | 动作含义                                                                                        |
| ----------- | ----------------------------------------------------------------------------------------------- |
| touchstart  | 当手指触摸屏幕时候触发，即使已经有一个手指放在屏幕上也会触发。                                  |
| touchmove   | 当手指在屏幕上滑动的时候连续地触发。在这个事件发生期间，调用 preventDefault()事件可以阻止滚动。 |
| touchend    | 当手指从屏幕上离开的时候触发                                                                    |
| touchcancel | 当系统停止跟踪触摸的时候触发                                                                    |

### 如何跟随手指移动？

利用这些事件，event.touches[0].clientX，有触摸点的位置，就可以进行位置的移动。

## 响应式

rem 单位，是相对于 html 的根元素的字体大小的倍数。只要调整 html 的根元素字体的大小就能够对布局进行等比例缩放，从而做到自适应。

### 响应式设计和布局

在不同设备上正常使用，一般主要处理屏幕大小问题

- 隐藏 + 折行 + 自适应空间
- rem 做单位
- viewport
  - width=divice-width,
- 媒体查询

#### 1. meta 标签的实用

设置布局宽度等于设备宽度，布局 viewport 等于度量 viewport

```html
<meta name="viewport" content="width=device-width,initial-scale=1" />
```

### 媒体查询

> HTML 4 和 CSS 2 目前支持为不同的媒体类型设定专有的样式表, 比如, 一个页面在屏幕上显示时使用无衬线字体, 而在打印时则使用衬线字体, screen 和 print 是两种已定义的媒体类型, 媒体查询让样式表有更强的针对性, 扩展了媒体类型的功能;媒体查询由媒体类型和一个或多个检测媒体特性的条件表达式组成, 媒体查询中可用于检测的媒体特性有 width、height 和 color（等）, 使用媒体查询, 可以在不改变页面内容的情况下, 为特定的一些输出设备定制显示效果。

语法

```css
@media screen and (max-width: 960px) {
  ....;
}
```

### 移动端的布局

可以通过百分比，rem，vw，vh 等自适应方式实现布局。

### viewport 和移动端布局方案

### 移动端适配方案，除了 rem, vw, 还有什么方案？

淘宝的 flexible.js 来做屏幕适配，然后面试官询问了它的实现原理，以及浏览器中几种长度单位（rem、em、px）的特点和区别

## 其他

- Hybird 模式的应用如何保证性能？

### iOS 下软键盘输入框遮挡遇到过问题么？怎么解决顶不起来的问题？

低版本 IOS 会出现，键盘弹起，但是输入框被遮挡的问题，可以键盘弹起事件，自定义一个滚动事件，滚到输入框的位置。

### 做过离线包吗？H5 离线包的原理？客户端根据什么拦截静态资源请求？

### 移动端适配方案（必考）

### 移动端适配 1px 的问题

### 骨架屏是什么

### 如何改善首屏优化和白屏
