---
title: mobile
date: 2020-11-21
draft: true
---

### 1. 弹出数字键盘

```
<!-- 有"#" "*"符号输入 -->
<input type="tel">

<!-- 纯数字 -->
<input pattern="\d*">
```

`安卓`跟`IOS`的表现形式应该不一样，大家可以自己试试。当运用了正则`pattern`后，就不用关注`input`的类型了 😂

![img](https://mmbiz.qpic.cn/mmbiz_gif/iaibsyicqkwnjuWg2Mn4MS0DkicHmQCNtl9CMC06KmrdXpbhESELMwVnCe48aicogMv6fu4RMSwpVVUw7e5NqMDAVCA/640?wx_fmt=gif&tp=webp&wxfrom=5&wx_lazy=1)

### 2. 调用系统的某些功能

```
<!-- 拨号 -->
<a href="tel:10086">打电话给: 10086</a>

<!-- 发送短信 -->
<a href="sms:10086">发短信给: 10086</a>

<!-- 发送邮件 -->
<a href="mailto:839626987@qq.com">发邮件给：839626987@qq.com</a>

<!-- 选择照片或者拍摄照片 -->
<input type="file" accept="image/*">

<!-- 选择视频或者拍摄视频 -->
<input type="file" accept="video/*">

<!-- 多选 -->
<input type="file" multiple>
```

同上 🤦‍♂️

![img](https://mmbiz.qpic.cn/mmbiz_gif/iaibsyicqkwnjuWg2Mn4MS0DkicHmQCNtl9CH7hN2Ttica9OFpAZ7Q6hhbFQKD6357KNPr9DzGTiah1XRLOfZFItvDrg/640?wx_fmt=gif&tp=webp&wxfrom=5&wx_lazy=1)

### 3. 打开原生应用

```
<a href="weixin://">打开微信</a>
<a href="alipays://">打开支付宝</a>
<a href="alipays://platformapi/startapp?saId=10000007">打开支付宝的扫一扫功能</a>
<a href="alipays://platformapi/startapp?appId=60000002">打开支付宝的蚂蚁森林</a>
```

这种方式叫做`URL Scheme`，是一种协议，一般用来访问`APP`或者`APP`中的某个功能/页面（如唤醒`APP`后打开指定页面或者使用某些功能）😒

`URL Scheme`的基本格式如下：

```
     行为(应用的某个功能/页面)
            |
scheme://[path][?query]
   |               |
应用标识       功能需要的参数
```

一般是由`APP`开发者自己定义，比如规定一些`参数`或者`路径`让其他开发者来访问，就像上面的例子 🍤

注意事项：

- 唤醒`APP`的条件是你的手机已经安装了该`APP`
- 某些浏览器会禁用此协议，比如微信内部浏览器（除非开了白名单）

![img](https://mmbiz.qpic.cn/mmbiz_gif/iaibsyicqkwnjuWg2Mn4MS0DkicHmQCNtl9C1KTnnibstIzyog2PnQx10dExzFlm6HKrvUx2gcnCmdkqKvf3uyoXclw/640?wx_fmt=gif&tp=webp&wxfrom=5&wx_lazy=1)

后面应该会专门写一篇文章用来探讨唤醒`APP`😒

### 4. 解决 active 伪类失效

```
<body ontouchstart></body>
```

给`body`注册一个空事件即可 😂

### 5. 忽略自动识别

```
<!-- 忽略浏览器自动识别数字为电话号码 -->
<meta name="format-detection" content="telephone=no">

<!-- 忽略浏览器自动识别邮箱账号 -->
<meta name="format-detection" content="email=no">
```

当页面上的内容包含了`手机号/邮箱`等，会自动转换成可点击的链接 😁

比如你有如下代码：

```
<p>13192733603</P>
```

但是有些浏览器会识别为手机，并且可以点击拨号。

### 6. 解决 input 失焦后页面没有回弹

![img](https://mmbiz.qpic.cn/mmbiz_gif/iaibsyicqkwnjuWg2Mn4MS0DkicHmQCNtl9Clm6ysUMCxZmoNEP3RhoiaeDgNO8SM9M53Ec9iar2zXgaUkt4lzSsz9UQ/640?wx_fmt=gif&tp=webp&wxfrom=5&wx_lazy=1)

一般出现在`IOS设备中的微信内部浏览器`，出现的条件为：

- 页面高度过小
- 聚焦时，页面需要往上移动的时候

所以一般`input`在页面上方或者顶部都不会出现无法回弹 🤣

解决办法为，在聚焦时，获取当前滚动条高度，然后失焦时，赋值之前获取的高度：

```
<template>
  <input type="text" @focus="focus" @blur="blur">
</template>

<script>
  export default {
    data() {
      return {
        scrollTop: 0
      }
    },

    methods: {
      focus() {
        this.scrollTop = document.scrollingElement.scrollTop;
      },

      blur() {
        document.scrollingElement.scrollTo(0, this.scrollTop);
      }
    }
  }
</script>
```

### 6. 禁止长按

![img](https://mmbiz.qpic.cn/mmbiz_gif/iaibsyicqkwnjuWg2Mn4MS0DkicHmQCNtl9CHZY4Ok8aWyd8HHyOQh8WL47Lhvt5qtK6IKKRsjWgLbJxJ9ibgEAcPicg/640?wx_fmt=gif&tp=webp&wxfrom=5&wx_lazy=1)

以上行为可以总结成这几个（每个手机以及浏览器的表现形式不一样）：`长按图片保存`、`长按选择文字`、`长按链接/手机号/邮箱时呼出菜单`。

想要禁止这些浏览器的默认行为，可以使用以下`CSS`：

```
// 禁止长按图片保存
img {
  -webkit-touch-callout: none;
  pointer-events: none; // 像微信浏览器还是无法禁止，加上这行样式即可
}

// 禁止长按选择文字
div {
  -webkit-user-select: none;
}

// 禁止长按呼出菜单
div {
  -webkit-touch-callout: none;
}
```

### 7. 滑动不顺畅，粘手

一般出现在`IOS`设备中，自定义盒子使用了`overflow: auto || scroll`后出现的情况。

优化代码：

```
div {
  -webkit-overflow-scrolling: touch;
}
```

### 8. 屏幕旋转为横屏时，字体大小会变

具体出现的情况不明 😒，有时候有有时候没有，欢迎指出。

优化代码：

```
* {
  -webkit-text-size-adjust: 100%;
}
```

### 9. 最简单的 rem 自适应

大家都知道，`rem`的值是根据`根元素的字体大小`相对计算的，但是我们每个设备的大小不一样，所以`根元素的字体大小`要动态设置 😂

```
html {
 font-size: calc(100vw / 3.75);
}

body {
  font-size: .14rem;
}
```

效果如下：

![img](https://mmbiz.qpic.cn/mmbiz_gif/iaibsyicqkwnjuWg2Mn4MS0DkicHmQCNtl9CS0pwEibOpomE4W87zDiaEqKOcqiadZS5j0TAtwKNF3KiaSlv0j9YhaGkfw/640?wx_fmt=gif&tp=webp&wxfrom=5&wx_lazy=1)

像我一般的话，直接搞`lib-flexible`、`postcss-pxtorem`就完事啦！

### 10. 滑动穿透

当你想在出现`遮罩`的时候，锁住用户的滚动行为，你可以这么做。

假设`HTML`结构如下：

```
<div class="mask">
  <div class="content">我是弹框</div>
</div>
```

`CSS`样式如下：

```
.mask {
  position: fixed;
  top: 0;
  left: 0;
  display: flex;
  justify-content: center;
  align-items: center;
  width: 100%;
  height: 100%;
  background-color: rgba($color: #333, $alpha: .6);

  .content {
    padding: 20px;
    background-color: #fff;
    width: 300px;
  }
}
```

效果如下：

![img](https://mmbiz.qpic.cn/mmbiz_gif/iaibsyicqkwnjuWg2Mn4MS0DkicHmQCNtl9CXTAVKgfmIMk5Sww0ffDcJicibohNEyDzUYzZt3Osj5oGbOZwRcvCWdjg/640?wx_fmt=gif&tp=webp&wxfrom=5&wx_lazy=1)

可以看到，当在`遮罩`上滑动的时候，是会穿透到父节点的，最简单的办法就是阻住默认行为：

```
document.querySelector(".mask").addEventListener("touchmove", event => {
  event.preventDefault();
});
```

如果在`vue`中，你可以这么写：

```
<div class="mask" @touchumove.prevent></div>
```

如果`.content`也有滚动条，那么只要阻止`遮罩`本身就行：

```
document.querySelector(".mask").addEventListener("touchmove", event => {
  if (event.target.classList.contains("mask")) event.preventDefault();
});
```

或者：

```
<div class="mask" @touchumove.self.prevent></div>
```
