---
title: 懒加载的实现原理
date: '2020-10-26'
draft: true
---

### 堆，栈，队列的区别

申请方式
内存中的堆和栈第一个区别就是申请方式的不同：栈是系统自动分配空间的，而堆则是程序员根据需要自己申请的空间。由于栈上的空间是自动分配自动回收的，所以栈上的数据的生存周期只是在函数的运行过程中，运行后就释放掉，不可以再访问。而堆上的数据只要程序员不释放空间，就一直可以访问到，不过缺点是一旦忘记释放会造成内存泄露。
申请效率的比较：栈由系统自动分配，速度较快。但程序员是无法控制的。堆是由 new 分配的内存，一般速度比较慢，而且容易产生内存碎片，不过用起来最方便。

申请大小的限制：
栈：在 Windows 下，栈是向低地址扩展的数据结构，是一块连续的内存的区域。这句话的意思是栈顶的地址和栈的最大容量是系统预先规定好的，在 Windows 下，栈的大小是 2M（也有的说是 1M，总之是一个编译时就确定的常数），如果申请的空间超过栈的剩余空间时，将提示 overflow。因此，能从栈获得的空间较小。
堆：堆是向高地址扩展的数据结构，是不连续的内存区域。这是由于系统是用链表来存储空闲内存地址的，自然是不连续的，而链表的遍历方向是由低地址向高地址。堆的大小受限于计算机系统中有效的虚拟内存。由此可见，堆获得的空间比较灵活，也比较大。

### Javascript 是一种弱类型语言，它分别有什么优点和缺点？

优点：弱类型使用简单，更灵活多变。
缺点：因为不包含类型信息，所以在代码的上下文中，可能会进行隐含的类型转换，比如把字符串转整型，整型转字符串，这样会稍损性能，并且可能会不符合程序本意。

### eval 是做什么的？

它的功能是把对应的字符串解析成 JS 代码并运行
应该避免使用 eval，不安全，非常耗性能（2 次，一次解析成 js 语句，一次执行）
由 JSON 字符串转换为 JSON 对象的时候可以用 eval，var obj =eval(‘(‘+ str +’)’)

它的功能是把对应的字符串解析成 JS 代码并运行；
应该避免使用 eval，不安全，非常耗性能（2 次，一次解析成 js 语句，一次执行）。

### JS 是如何运行的？

- 线程和进程
- EventLoop 微任务和宏任务
- JS 中的垃圾回收

### javascript 的运行机制

- 由于 js 是单线程，js 将所有任务分成两种，一种是同步任务（synchronous），另一种是异步任务（asynchronous）。
- 同步任务指的是，在主线程上排队执行的任务，只有前一个任务执行完毕，才能执行后一个任务；
- 异步任务指的是，不进入主线程、而进入"任务队列"（task queue）的任务，只有"任务队列"通知主线程，某个异步任务可以执行了，该任务才会进入主线- 程执行。
- 在所有同步任务执行完之前，任何的异步任务是不会执行的
- 异步执行的运行机制如下：

  1. 所有同步任务都在主线程上执行，形成一个执行栈（execution context stack）。
  2. 主线程之外，还存在一个"任务队列"（task queue）。只要异步任务有了运行结果，就在"任务队列"之中放置一个事件。
  3. 一旦"执行栈"中的所有同步任务执行完毕，系统就会读取"任务队列"，看看里面有哪些事件。那些对应的异步任务，于是结束等待状态，进入执行栈，开始执行。
  4. 主线程不断重复上面的第三步。
     主线程从"任务队列"中读取事件，这个过程是循环不断的，所以整个的这种运行机制又称为 Event Loop（事件循环）只要主线程空了，就会去读取"任务队列"，这就是 JavaScript 的运行机制

- 一般来说，有以下四种会放入异步任务队列:
  1. setTimeout 和 setInterval
  1. DOM 事件
  1. ES6 中的 Promise
  1. Ajax 异步请求

### 垃圾回收

JavaScript 自动回收，注意一点，尽量解除不适用的全局变量。
尽可能的去使用局部变量，因为函数使用之后就会销毁掉，少用全局变量。全局变量查找的时候，从内部往外找，会有一定的影响。

### delete

将一个属性给删除：

1. 将这个属性定义为 null
2. 将这个属性赋值为 undefined
3. 使用 delete 关键字：delete obj.name 能够删除复杂变量的属性和方法，但是不能够删除变量本身，如果使用，会删除失败。

### 清空一个 js 数组

```js
var arrayList = ['a', 'b', 'c', 'd', 'e', 'f'];

// 1
arrayList = [];
// 2
arrayList.length = 0;
// 3
arrayList.splice(0, arrayList.length);
// 4
while (arrayList.length) {
  arrayList.pop();
}
```

### js 浮点数运算不精确 如何解决?

### JavaScript 如何判断一个对象是空的？

- 第一种： `const isEmptyObject = obj => Object.getOwnPropertyNames(obj).length === 0`
- 第二种： `Object.keys(obj).length == 0`

### 其他

- 只要为 img 标签设置了 src 属性，无论是 display: none 还是 visibility: hidden 都会产生请求；把图片设置为不存在的属性，比如 data-src 此时 display: none 还是 visibility: hidden 都不会产生请求
- 如何创建一个真正的 private 方法
- 什么是 undefined x 1 ？
- JavaScript 中不同类型以及不同环境下变量的内存都是何时释放?
