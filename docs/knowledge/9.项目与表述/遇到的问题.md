---
title: 遇到的问题
date: 2020-11-21
aside: false
draft: true
---

## 功能类

### 驾驶舱的顶部 Tab 渲染同 ID 的 Item 的顺序错乱现象

对于一个 Tab 组件，传入的一个元素是 Tab 对象的数组，渲染一个 Tabs 列表。 数据举例如下：

```js
const A = [0, 1, 2, 3];

const B = [0, 1, 2];
```

对于 A B 两个数组， 最后一个元素的 Id 相等，前面的 Id 都不同。在切换 Tabs 的过程中，就是替换 A B 数组的值。但是每次切换的过程中，最后一个 Tab 位置总是会跑到第一位（首次渲染的位置相同。）， 后来想了一下这个原因是因为 Vue 在增加删除节点的时候，相同的 Key 的元素，就当做旧元素，已经消失的 Key 元素，节点会被删除；而原本不存在的节点，会被作为新 Key 插入到后面。 这就是为什么，最后一个 Tab 元素在切换过程中跑到最前面去的原因，这里只要改一下，用不同的 Key 值即可。

### 页面跳转之前的请求没有结束，会被 cancel

https://segmentfault.com/a/1190000013132078

日志上报的失败率比较高，很多都是直接被 cancel (abort) 调的。

使用 `navigator.sendBeacon` 打点上报有一个好处， 对于页面直接跳转的情况，也能上报数据，而不会被 cancel。 所以 navigator.sendBeacon 的部分，其实并不需要 await 它，正常写同步的顺序就好。

### 正则匹配中文出错

背景：如何使用正则判断字符串中是否全部是中文？
通过百度或者 google 之后得到的答案一般都是：

```
const reg = /^[\u4e00-\u9fa5]*$/
reg.test('中文')
```

但是实际上遇到了一个中文 "䃼" 的时候，正则就返回了错误。 一开始没有意识到这是一个不常见的中文，或者换句话说没有意识到不常见的中文没有落在上面的正则表达式里。在线中文转化 unicode 之后得到这个字的 unicode 编码是 "\u40fc", 看起来确实没有落在上面正则的范围里。补上一般完整的中文编码符号。https://blog.bvcode.com/res/159/

## 性能优化类

### 前端安全问题

CSRF ？？？

g_tk 算法

https://www.cnblogs.com/a849788087/p/6440264.html

http://km.oa.com/articles/show/409728

## 白屏问题排查

https://www.cnblogs.com/thinkingthigh/p/11057079.html

/authorize 白屏页

npm 包的扩展运算符。 不能在 ios 12.1 14.4 上跑起来。
