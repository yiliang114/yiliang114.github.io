---
title: 类型转换
date: '2020-11-02'
draft: true
---

### 用 Array 的 reduce 方法实现 map 方法（头条一面）

### 给出数组超过半数的数字，不存在的话输出没有（要求时间复杂度最低）

```js
function moreThanHalf(arr) {
  if (arr && Array.isArray(arr)) {
    var times = (result = index = 0);
    for (; index < arr.length; index++) {
      if (times === 0) {
        result = arr[index];
        times++;
      } else if (result !== arr[index]) {
        times--;
      } else {
        times++;
      }
    }
    if (times) {
      times = index = 0;
      for (; index < arr.length; index++) {
        if (result === arr[index]) {
          times++;
        }
      }
      if (times > arr.length / 2) {
        return result;
      }
    }
  }
  return '没有';
}
```

### 为数组写一个检测是否包含值方法：contains()

```js
if (!Array.prototype.contains) {
  Array.prototype.contains = function(value) {
    for (var i = 0, len = this.length, item; i < len; i++) {
      item = this[i];
      if (item === value) {
        return true;
      }
    }
    return false;
  };
}
```

### 扁平化

#### 实现 flatten 函数

迭代实现

```js
function flatten(arr) {
  let arrs = [...arr];
  let newArr = [];
  while (arrs.length) {
    let item = arrs.shift();
    if (Array.isArray(item)) {
      arrs.unshift(...item);
    } else {
      newArr.push(item);
    }
  }
  return newArr;
}
```

递归实现

```js
function flatten(arr) {
  let arrs = [];
  arr.map(item => {
    if (Array.isArray(item)) {
      arrs.push(...flatten(item));
    } else {
      arrs.push(item);
    }
  });
  return arrs;
}
```

使用 toString

```js
var c = [1, 3, 4, 5, [6, [0, 1, 5], 9], [2, 5, [1, 5]], [5]];
var b = c.toString().split(',');
```

使用 es6 的 reduce 函数

```js
var arr = [1, 3, 4, 5, [6, [0, 1, 5], 9], [2, 5, [1, 5]], [5]];
const flatten = arr => arr.reduce((a, b) => a.concat(Array.isArray(b) ? flatten(b) : b), []);
var result = flatten(arr);
```
