<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>jquery 源码 | 易良同学的博客</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="shortcut icon" href="/favicon.ico" type="image/jpg">
    <link rel="manifest" href="/manifest.json">
    <meta name="description" content="最主要的几个部分，1. 变量常量正则的初始化 2. 工具方法$.fn 3. 状态$.ready 4. 对元素属性的操作有 attr(),prop(),addClass()之类的方法 5. dom 操作，样式操作 6. ajax 封装 7. 模块化 8. 动画 animation() 9. 位置和尺寸 offset() 10. window.jQuery = window.\$ = jQuery">
    <meta name="twitter:title" content="jquery 源码">
    <meta name="twitter:description" content="最主要的几个部分，1. 变量常量正则的初始化 2. 工具方法$.fn 3. 状态$.ready 4. 对元素属性的操作有 attr(),prop(),addClass()之类的方法 5. dom 操作，样式操作 6. ajax 封装 7. 模块化 8. 动画 animation() 9. 位置和尺寸 offset() 10. window.jQuery = window.\$ = jQuery">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:url" content="https://yiliang.site/_posts/%E7%9F%A5%E8%AF%86%E5%BA%93/JQuery/jquery%E6%BA%90%E7%A0%81.html">
    <meta property="og:type" content="article">
    <meta property="og:title" content="jquery 源码">
    <meta property="og:description" content="最主要的几个部分，1. 变量常量正则的初始化 2. 工具方法$.fn 3. 状态$.ready 4. 对元素属性的操作有 attr(),prop(),addClass()之类的方法 5. dom 操作，样式操作 6. ajax 封装 7. 模块化 8. 动画 animation() 9. 位置和尺寸 offset() 10. window.jQuery = window.\$ = jQuery">
    <meta property="og:url" content="https://yiliang.site/_posts/%E7%9F%A5%E8%AF%86%E5%BA%93/JQuery/jquery%E6%BA%90%E7%A0%81.html">
    <meta property="og:site_name" content="易良 yiliang">
    <meta property="article:published_time" content="2019-11-21T00:00:00.000Z">
    <meta itemprop="name" content="jquery 源码">
    <meta itemprop="description" content="最主要的几个部分，1. 变量常量正则的初始化 2. 工具方法$.fn 3. 状态$.ready 4. 对元素属性的操作有 attr(),prop(),addClass()之类的方法 5. dom 操作，样式操作 6. ajax 封装 7. 模块化 8. 动画 animation() 9. 位置和尺寸 offset() 10. window.jQuery = window.\$ = jQuery">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    
    <link rel="preload" href="/assets/js/vendor.vue.22470dd9.js" as="script"><link rel="preload" href="/assets/css/0.styles.63940afe.css" as="style"><link rel="preload" href="/assets/js/vendor.commons.63940afe.js" as="script"><link rel="preload" href="/assets/js/app.34947d8e.js" as="script"><link rel="preload" href="/assets/js/30.7dcc7a8c.js" as="script"><link rel="prefetch" href="/assets/js/10.9a756169.js"><link rel="prefetch" href="/assets/js/11.85f8dab7.js"><link rel="prefetch" href="/assets/js/12.b4cc6c17.js"><link rel="prefetch" href="/assets/js/13.fbfbe27e.js"><link rel="prefetch" href="/assets/js/14.dd96edfa.js"><link rel="prefetch" href="/assets/js/15.55718840.js"><link rel="prefetch" href="/assets/js/16.73f8e254.js"><link rel="prefetch" href="/assets/js/17.9f60deb8.js"><link rel="prefetch" href="/assets/js/18.ac011fe0.js"><link rel="prefetch" href="/assets/js/19.495fea85.js"><link rel="prefetch" href="/assets/js/20.b94e8387.js"><link rel="prefetch" href="/assets/js/21.a899318f.js"><link rel="prefetch" href="/assets/js/22.8e8c9ab8.js"><link rel="prefetch" href="/assets/js/23.635fbb1c.js"><link rel="prefetch" href="/assets/js/24.2c7afe79.js"><link rel="prefetch" href="/assets/js/25.4a17c9ae.js"><link rel="prefetch" href="/assets/js/26.d1b3b48a.js"><link rel="prefetch" href="/assets/js/27.9d447c0a.js"><link rel="prefetch" href="/assets/js/28.ab638595.js"><link rel="prefetch" href="/assets/js/29.049a9710.js"><link rel="prefetch" href="/assets/js/3.5778f50e.js"><link rel="prefetch" href="/assets/js/31.ab880fe4.js"><link rel="prefetch" href="/assets/js/32.0e0cbd28.js"><link rel="prefetch" href="/assets/js/33.d0f8a4fc.js"><link rel="prefetch" href="/assets/js/34.0d1eca53.js"><link rel="prefetch" href="/assets/js/35.8f67d7e8.js"><link rel="prefetch" href="/assets/js/36.7f1e0fe5.js"><link rel="prefetch" href="/assets/js/37.8207e352.js"><link rel="prefetch" href="/assets/js/38.fcb47a79.js"><link rel="prefetch" href="/assets/js/39.e26e8758.js"><link rel="prefetch" href="/assets/js/4.6697030e.js"><link rel="prefetch" href="/assets/js/40.511b7362.js"><link rel="prefetch" href="/assets/js/41.23980a04.js"><link rel="prefetch" href="/assets/js/42.7d812c8f.js"><link rel="prefetch" href="/assets/js/43.e9f4c163.js"><link rel="prefetch" href="/assets/js/44.a70b510d.js"><link rel="prefetch" href="/assets/js/45.0e3f6992.js"><link rel="prefetch" href="/assets/js/46.42614d9e.js"><link rel="prefetch" href="/assets/js/47.acc03387.js"><link rel="prefetch" href="/assets/js/48.1f987f52.js"><link rel="prefetch" href="/assets/js/49.53a7fd46.js"><link rel="prefetch" href="/assets/js/5.c3113993.js"><link rel="prefetch" href="/assets/js/50.eb913ef1.js"><link rel="prefetch" href="/assets/js/51.24dbae80.js"><link rel="prefetch" href="/assets/js/52.5fcfa379.js"><link rel="prefetch" href="/assets/js/53.fd9f3e2b.js"><link rel="prefetch" href="/assets/js/54.56ca5860.js"><link rel="prefetch" href="/assets/js/55.5997fac6.js"><link rel="prefetch" href="/assets/js/56.9c74e6d6.js"><link rel="prefetch" href="/assets/js/57.f24bf036.js"><link rel="prefetch" href="/assets/js/58.5c310d29.js"><link rel="prefetch" href="/assets/js/6.72d4d30e.js"><link rel="prefetch" href="/assets/js/7.64e679fc.js"><link rel="prefetch" href="/assets/js/8.f5c49058.js"><link rel="prefetch" href="/assets/js/9.b9fcef5c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.63940afe.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-yiliang114"><header class="header" data-v-684ee972><div data-v-0b0af033 data-v-684ee972><nav class="navbar" data-v-0b0af033><div class="container" data-v-0b0af033><a href="/" class="router-link-active" data-v-0b0af033><span class="navbar-site-name" data-v-0b0af033>易良同学的博客</span></a> <div class="navbar-toggler" data-v-0b0af033><svg class="icon" style="font-size:1.2em;" data-v-0b0af033 data-v-0b0af033><title data-v-0b0af033 data-v-0b0af033>menu</title><use xlink:href="#icon-menu" data-v-0b0af033 data-v-0b0af033></use></svg></div> <div class="navbar-links" data-v-0b0af033><a href="/" class="navbar-link" data-v-0b0af033>首页</a><a href="/posts/" class="navbar-link router-link-active" data-v-0b0af033>文章</a><a href="/posts/categories/" class="navbar-link" data-v-0b0af033>分类</a><a href="/links/" class="navbar-link" data-v-0b0af033>友链</a></div></div></nav> <div class="navbar-holder" style="display:none;" data-v-0b0af033></div></div> <div class="banner" data-v-4f70089d data-v-684ee972 data-v-684ee972><div class="container" data-v-4f70089d><div class="center" data-v-4f70089d><h1 data-v-4f70089d data-v-684ee972>jquery 源码</h1></div></div></div></header> <div class="container clearfix" data-v-5e7fbdae data-v-5e7fbdae><main class="main" data-v-5e7fbdae><div class="post" data-v-5e7fbdae><section class="post-meta main-div" data-v-42efe1fc><section class="post-date clearfix" data-v-42efe1fc><span class="create-date" data-v-42efe1fc>发布时间 : 2019-11-21</span> <!----></section> <section class="post-links" data-v-42efe1fc><a href="/posts/2019/10/25/vscode-%E5%BF%AB%E6%8D%B7%E9%94%AE.html" class="post-link" data-v-42efe1fc>上一篇 : vscode 标签的展开收起</a> <a href="/posts/2019/11/21/jquery-zh.html" class="post-link" data-v-42efe1fc>下一篇 : JQuery 源码分析</a></section></section> <article class="main-div"><div class="post-content content content__default"><h1 id="jquery-源码"><a href="#jquery-源码" class="header-anchor">#</a> jquery 源码</h1> <p>最主要的几个部分，1. 变量常量正则的初始化 2. 工具方法<code>$.fn</code> 3. 状态<code>$.ready</code> 4. 对元素属性的操作有 attr(),prop(),addClass()之类的方法 5. dom 操作，样式操作 6. ajax 封装 7. 模块化 8. 动画 animation() 9. 位置和尺寸 offset() 10. window.jQuery = window.$ = jQuery</p> <p>虽然 jq 有作用域提升机制，但是 9000 多行的代码基本上只有全局都会用到的变量和正则定义在代码最开头，而每个模块一开始又会定义一些在本模块中用到的变量正则等。</p> <ol><li>jq 的闭包结构是 function 参数是 window 和 undefined，传入的参数是 window，避免污染全局变量。这样的写法代码压缩的时候参数会成为 w 和 u</li> <li>jq 的无 new 构造，可以直接用$进行构造，这很便捷，但是实质上还是 new jq()</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">jquery</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">selector<span class="token punctuation">,</span>context</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Jquery<span class="token punctuation">.</span>fn<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span>selector<span class="token punctuation">,</span>context<span class="token punctuation">,</span>rootjQuery<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
jQuery<span class="token punctuation">.</span>fn <span class="token operator">=</span> jQuery<span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// jQuery构造器</span>
    <span class="token function-variable function">init</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">selector<span class="token punctuation">,</span>context<span class="token punctuation">,</span>rootjQuery</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 然后将init函数的原型属性设置为jq.fn</span>
jQuery<span class="token punctuation">.</span>fn<span class="token punctuation">.</span>init<span class="token punctuation">.</span>prototype <span class="token operator">=</span> jQuery<span class="token punctuation">.</span>fn
</code></pre></div><p>$()这种调用方式实际上调用的是 new jq fn init 函数，也就是说，构造实例的工作实际上是 init 函数完成的。然后 jQuery.fn.init.prototype 设置为 jQuery.fn，那么使用 new jq fn init 生成的对象的原型就是 jq fn，那么所有挂载在 jq fn 上面的函数就相当于挂载到了 jq fn init 函数生成的对象上，所以这样生成的对象都能够使用 jq fn 上的原型方法。嗯。。。所以其实 jq fn init prototy = jq fn = jq prototype 所以，无 new 的构造其实是跟直接 new 是一样的。</p> <ol start="3"><li>jq 的方法重载。读这部分源码的时候发现很复杂很繁琐，因为 jq 是为了通用性更强，兼容更多的情况。比如说获取和设置标签属性都可以用<code>$().attr()</code>,获取和设置 css 属性都可以用<code>$().css()</code>，jQuery()有更多的功能，比如说传入 dom 和传入对象，传入数组的 dom，传入 html 字符串等等，就是一个方法实现了很多的功能，又是 get 又是 set</li> <li>jq 内部常常用 extend 来扩展静态方法和实例方法。但是在内部实际上存在 jq fn extend 与 jq extend。基本上我理解的 jq extend 扩展的静态方法，可以直接使用<code>$.xxx</code>进行使用，因为<code>$</code>是 jq 对象，而使用 jq fn extend 扩展的实例方法需要使用<code>$().xxx</code>进行调用，因为<code>$().xxx</code>才是一个实例。但是需要注意的是事实上有一部分的方法是 jq extend = jq fn extend = function(){}这样来声明的，就是说两个 extend 函数共用了同一个方法，却实现了不同的功能，这主要是 js 中的 this 不同，jq extend 中的 this 是 jq 对象，所以方法都扩展在 jq 类上。而 jq fn extend 中的 this 是指向 fn 对象的，因为 jq fn = jq prototype 所以这也就增加了原型方法，也就是实例对象的方法。</li> <li>链式调用，最重要的步骤是<code>return this</code>，就能实现链式调用。jq 支持的回溯（指可以链式调用中可以回到上一步的对象），是依靠添加了 prevObject 这个属性实现的，这个属性是由 pushStack()方法生成的，具体的实现忘了，跟内部管理的栈相关。当链式调用执行 end()方法后，内部就返回了 jq 对象的 prevObject 属性，完成回溯。</li> <li>预定义常用方法。首先定义了一个对象、字符串和数组变量，然后通过这三个来定义对应的对象、字符串数组的方法入 concat slice push 等等 如 core_slice = 字符串名.slice 然后再实际调用的时候就直接 core_slice.call(this)，来替代 Array.prototype.slice.call(this)。如果不这么做的话，每次都要从 Array 中找，而且还需要判断变量的类型是否是 string。</li></ol></div></article> <section class="post-meta main-div" data-v-42efe1fc><section class="post-date clearfix" data-v-42efe1fc><span class="create-date" data-v-42efe1fc>发布时间 : 2019-11-21</span> <!----></section> <section class="post-links" data-v-42efe1fc><a href="/posts/2019/10/25/vscode-%E5%BF%AB%E6%8D%B7%E9%94%AE.html" class="post-link" data-v-42efe1fc>上一篇 : vscode 标签的展开收起</a> <a href="/posts/2019/11/21/jquery-zh.html" class="post-link" data-v-42efe1fc>下一篇 : JQuery 源码分析</a></section></section> <div id="post-comments" class="main-div"><!----></div></div></main> <aside class="aside" data-v-5e7fbdae><!----> <!----> <div class="post-nav-card main-div" data-v-5e7fbdae><!----> <div class="post-nav-comments"><svg class="icon"><title>comment</title><use xlink:href="#icon-comment"></use></svg> <a href="/posts/2019/11/21/jquery%E6%BA%90%E7%A0%81.html#post-comments">评论</a></div></div></aside></div> <footer class="footer" data-v-fcc2f45a><p class="footer-sns-links" data-v-fcc2f45a><a href="https://github.com/yiliang114" target="_blank" rel="noopener" class="sns-link" data-v-fcc2f45a><span title="GitHub: yiliang" class="sns-icon" data-v-fcc2f45a data-v-fcc2f45a><svg class="icon" style="font-size:25px;" data-v-fcc2f45a data-v-fcc2f45a><title data-v-fcc2f45a data-v-fcc2f45a>GitHub: yiliang</title><use xlink:href="#icon-github" data-v-fcc2f45a data-v-fcc2f45a></use></svg></span></a><a href="https://twitter.com/yiliang79503471" target="_blank" rel="noopener" class="sns-link" data-v-fcc2f45a><span title="Twitter: yiliang" class="sns-icon" data-v-fcc2f45a data-v-fcc2f45a><svg class="icon" style="font-size:25px;" data-v-fcc2f45a data-v-fcc2f45a><title data-v-fcc2f45a data-v-fcc2f45a>Twitter: yiliang</title><use xlink:href="#icon-twitter" data-v-fcc2f45a data-v-fcc2f45a></use></svg></span></a><a href="https://weibo.com/u/3386520174" target="_blank" rel="noopener" class="sns-link" data-v-fcc2f45a><span title="新浪微博: @易良同学" class="sns-icon" data-v-fcc2f45a data-v-fcc2f45a><svg class="icon" style="font-size:25px;" data-v-fcc2f45a data-v-fcc2f45a><title data-v-fcc2f45a data-v-fcc2f45a>新浪微博: @易良同学</title><use xlink:href="#icon-weibo" data-v-fcc2f45a data-v-fcc2f45a></use></svg></span></a><a href="https://www.zhihu.com/people/Mrz2J" target="_blank" rel="noopener" class="sns-link" data-v-fcc2f45a><span title="知乎: 易良" class="sns-icon" data-v-fcc2f45a data-v-fcc2f45a><svg class="icon" style="font-size:25px;" data-v-fcc2f45a data-v-fcc2f45a><title data-v-fcc2f45a data-v-fcc2f45a>知乎: 易良</title><use xlink:href="#icon-zhihu" data-v-fcc2f45a data-v-fcc2f45a></use></svg></span></a><a href="https://blog.csdn.net/GreekMrzzJ" target="_blank" rel="noopener" class="sns-link" data-v-fcc2f45a><span title="CSDN: yiliang" class="sns-icon" data-v-fcc2f45a data-v-fcc2f45a><svg class="icon" style="font-size:25px;" data-v-fcc2f45a data-v-fcc2f45a><title data-v-fcc2f45a data-v-fcc2f45a>CSDN: yiliang</title><use xlink:href="#icon-csdn" data-v-fcc2f45a data-v-fcc2f45a></use></svg></span></a><a href="https://juejin.im/user/58809a6db123db0061cfd1c3" target="_blank" rel="noopener" class="sns-link" data-v-fcc2f45a><span title="掘金: yiliang" class="sns-icon" data-v-fcc2f45a data-v-fcc2f45a><svg class="icon" style="font-size:25px;" data-v-fcc2f45a data-v-fcc2f45a><title data-v-fcc2f45a data-v-fcc2f45a>掘金: yiliang</title><use xlink:href="#icon-juejin" data-v-fcc2f45a data-v-fcc2f45a></use></svg></span></a></p> <!----> <p class="footer-text" data-v-fcc2f45a><span data-v-fcc2f45a>浙ICP备16046652号</span></p> <p class="footer-text" data-v-fcc2f45a>Copyright 2018-present <a href="https://github.com/yiliang114" target="_blank">yiliang114</a> | MIT License</p></footer></div><div class="global-ui"><!----><!----><div></div><canvas id="vuepress-canvas-cursor"></canvas><!----></div></div>
    <script src="/assets/js/vendor.vue.22470dd9.js" defer></script><script src="/assets/js/30.7dcc7a8c.js" defer></script><script src="/assets/js/vendor.commons.63940afe.js" defer></script><script src="/assets/js/app.34947d8e.js" defer></script>
  </body>
</html>
